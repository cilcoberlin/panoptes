
{% extends "panoptes/core/base.html" %}

{% load i18n %}
{% load panoptes_analysis %}

{% block css %}

	{{ block.super }}
	
	<link href="{{ MEDIA_URL }}panoptes/css/libs/jquery-ui/jquery.ui.css" type="text/css" media="all" rel="stylesheet" />
	<link href="{{ MEDIA_URL }}panoptes/css/libs/timepicker/timepicker.css" type="text/css" media="all" rel="stylesheet" />
	
	<link href="{{ MEDIA_URL }}panoptes/css/analysis.css" type="text/css" media="all" rel="stylesheet" />

	{{ lens_media.css }}

{% endblock %}

{% block title %}
	{% blocktrans with location.name as location %}
		{{ location }} Analytics
	{% endblocktrans %}
{% endblock %}

{% block body_classes %}analytics{% endblock %}

{% block body %}

	<div id="header">

		<h1 id="title">
			{% blocktrans with location.name|default:"Panoptes" as location %}
				<span class="location">{{ location }}</span> Analytics
			{% endblocktrans %}
		</h1>
		<h2 id="subtitle">{% if filters %}{% verbose_filters filters %}{% endif %}</h2>

	</div>

	<div id="content">
		
		<form method="post" action="{% url analysis location_slug=location.slug %}" id="data-filters">

			{% lens_form filter_form %}
	
			<fieldset class="submit-buttons">
				<input type="submit" value="{% trans "Filter Usage Data" %}" />
				{% csrf_token%}
			</fieldset>

		</form>
	
		
		<div id="panels">
			
			{% for panel in panels %}
				{{ panel.render }}
			{% endfor %}
			
		</div>

	</div>
	
	<div id="footer">
		<p>
			{% blocktrans %}
				Usage data generated by <a href="http://www.github.com/cilcoberlin/panoptes/">Panoptes</a>
			{% endblocktrans %}
		</p>
	</div>	

{% endblock %}

{% block javascript %}
	
	{{ block.super }}
	
	<script type="text/javascript">
		
		panoptes.analytics = {
			fragments: {},
			panels: {}
		};
		
		panoptes.urls['update-supporting-panels'] = "{% url update-supporting-panels %}";
		
		//<![CDATA[
			panoptes.analytics.fragments['loading'] = "{% loading_fragment %}";
		//]]>
		
	</script> 
	
	<script type="text/javascript" src="{{ MEDIA_URL }}panoptes/js/libs/jquery.form.2.69.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}panoptes/js/libs/jquery.ui.1.8.11.min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}panoptes/js/libs/jquery.timepicker.min.js"></script>
	
	<script type="text/javascript" src="{{ MEDIA_URL }}panoptes/js/analysis/analysis.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}panoptes/js/analysis/panels.js"></script>
	
	{{ lens_media.js }}
	
{% endblock %}
